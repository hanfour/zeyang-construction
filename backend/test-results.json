{"numFailedTestSuites":5,"numFailedTests":74,"numPassedTestSuites":3,"numPassedTests":49,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":8,"numTotalTests":123,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1753334160556,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["簡單 API 測試","公開端點測試"],"duration":31,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 公開端點測試 GET /health - 健康檢查","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"GET /health - 健康檢查"},{"ancestorTitles":["簡單 API 測試","公開端點測試"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 公開端點測試 GET / - API 資訊","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"GET / - API 資訊"},{"ancestorTitles":["簡單 API 測試","錯誤處理測試"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 錯誤處理測試 404 錯誤 - 不存在的路由","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"404 錯誤 - 不存在的路由"},{"ancestorTitles":["簡單 API 測試","錯誤處理測試"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 錯誤處理測試 400 錯誤 - 格式錯誤的 JSON","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"400 錯誤 - 格式錯誤的 JSON"},{"ancestorTitles":["簡單 API 測試","認證測試"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 認證測試 生成測試 Token","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"生成測試 Token"},{"ancestorTitles":["簡單 API 測試","認證測試"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 認證測試 需要認證的端點應返回 401","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"需要認證的端點應返回 401"},{"ancestorTitles":["簡單 API 測試","認證測試"],"duration":40,"failureDetails":[],"failureMessages":[],"fullName":"簡單 API 測試 認證測試 使用有效 Token 應可訪問受保護端點","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"使用有效 Token 應可訪問受保護端點"},{"ancestorTitles":["測試環境驗證"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"測試環境驗證 環境變數設置正確","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"環境變數設置正確"},{"ancestorTitles":["測試環境驗證"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"測試環境驗證 測試架構運作正常","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"測試架構運作正常"}],"endTime":1753334162931,"message":"","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/simple.test.js","startTime":1753334160814,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["API Integration Tests","Public Endpoints"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests Public Endpoints GET /health - should return health status","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"GET /health - should return health status"},{"ancestorTitles":["API Integration Tests","Public Endpoints"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests Public Endpoints GET / - should return API info","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"GET / - should return API info"},{"ancestorTitles":["API Integration Tests","Public Endpoints"],"duration":38,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests Public Endpoints GET /api/system/health - should return detailed health","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"GET /api/system/health - should return detailed health"},{"ancestorTitles":["API Integration Tests","Error Handling"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests Error Handling should return 404 for non-existent routes","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return 404 for non-existent routes"},{"ancestorTitles":["API Integration Tests","Error Handling"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests Error Handling should handle malformed JSON","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle malformed JSON"},{"ancestorTitles":["API Integration Tests","CORS Headers"],"duration":17,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests CORS Headers should include CORS headers","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should include CORS headers"},{"ancestorTitles":["API Integration Tests","CORS Headers"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests CORS Headers should handle OPTIONS requests","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle OPTIONS requests"},{"ancestorTitles":["Test Summary"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Test Summary should display test environment info","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should display test environment info"}],"endTime":1753334162961,"message":"","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/integration.test.js","startTime":1753334160766,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["System API Tests","GET /health"],"duration":27,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests GET /health should return health status","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return health status"},{"ancestorTitles":["System API Tests","GET /api/system/health"],"duration":48,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests GET /api/system/health should return detailed health status","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should return detailed health status"},{"ancestorTitles":["System API Tests","GET /api/system/info"],"duration":10,"failureDetails":[{"matcherResult":{"message":"expect(received).toHaveProperty(path)\n\nExpected path: \"uptime\"\nReceived path: []\n\nReceived value: {\"cpu\": {\"system\": 216249, \"user\": 1045821}, \"memory\": {\"arrayBuffers\": 6042127, \"external\": 7522004, \"heapTotal\": 91668480, \"heapUsed\": 60995488, \"rss\": 145276928}, \"nodeVersion\": \"v18.20.4\", \"version\": \"1.0.0\"}","pass":false}}],"failureMessages":["Error: expect(received).toHaveProperty(path)\n\nExpected path: \"uptime\"\nReceived path: []\n\nReceived value: {\"cpu\": {\"system\": 216249, \"user\": 1045821}, \"memory\": {\"arrayBuffers\": 6042127, \"external\": 7522004, \"heapTotal\": 91668480, \"heapUsed\": 60995488, \"rss\": 145276928}, \"nodeVersion\": \"v18.20.4\", \"version\": \"1.0.0\"}\n    at Object.toHaveProperty (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/system.test.js:49:34)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"System API Tests GET /api/system/info should return system info with admin role","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"failed","title":"should return system info with admin role"},{"ancestorTitles":["System API Tests","GET /api/system/info"],"duration":20,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 200 \"OK\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/system.test.js:57:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"System API Tests GET /api/system/info should fail without admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without admin role"},{"ancestorTitles":["System API Tests","GET /api/system/info"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests GET /api/system/info should fail without authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail without authentication"},{"ancestorTitles":["System API Tests","GET /"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests GET / should return API information","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return API information"},{"ancestorTitles":["System API Tests","404 Handler"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests 404 Handler should return 404 for non-existent endpoint","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return 404 for non-existent endpoint"},{"ancestorTitles":["System API Tests","CORS"],"duration":2,"failureDetails":[{"matcherResult":{"message":"expect(received).toHaveProperty(path)\n\nExpected path: \"access-control-allow-origin\"\nReceived path: []\n\nReceived value: {\"access-control-allow-credentials\": \"true\", \"connection\": \"close\", \"content-length\": \"98\", \"content-security-policy\": \"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests\", \"content-type\": \"application/json; charset=utf-8\", \"cross-origin-opener-policy\": \"same-origin\", \"cross-origin-resource-policy\": \"cross-origin\", \"date\": \"Thu, 24 Jul 2025 05:16:02 GMT\", \"etag\": \"W/\\\"62-Or/A1FwrWLKU5YgohZyOZBYJWzk\\\"\", \"origin-agent-cluster\": \"?1\", \"referrer-policy\": \"no-referrer\", \"strict-transport-security\": \"max-age=15552000; includeSubDomains\", \"vary\": \"Origin, Accept-Encoding\", \"x-content-type-options\": \"nosniff\", \"x-dns-prefetch-control\": \"off\", \"x-download-options\": \"noopen\", \"x-frame-options\": \"SAMEORIGIN\", \"x-permitted-cross-domain-policies\": \"none\", \"x-xss-protection\": \"0\"}","pass":false}}],"failureMessages":["Error: expect(received).toHaveProperty(path)\n\nExpected path: \"access-control-allow-origin\"\nReceived path: []\n\nReceived value: {\"access-control-allow-credentials\": \"true\", \"connection\": \"close\", \"content-length\": \"98\", \"content-security-policy\": \"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests\", \"content-type\": \"application/json; charset=utf-8\", \"cross-origin-opener-policy\": \"same-origin\", \"cross-origin-resource-policy\": \"cross-origin\", \"date\": \"Thu, 24 Jul 2025 05:16:02 GMT\", \"etag\": \"W/\\\"62-Or/A1FwrWLKU5YgohZyOZBYJWzk\\\"\", \"origin-agent-cluster\": \"?1\", \"referrer-policy\": \"no-referrer\", \"strict-transport-security\": \"max-age=15552000; includeSubDomains\", \"vary\": \"Origin, Accept-Encoding\", \"x-content-type-options\": \"nosniff\", \"x-dns-prefetch-control\": \"off\", \"x-download-options\": \"noopen\", \"x-frame-options\": \"SAMEORIGIN\", \"x-permitted-cross-domain-policies\": \"none\", \"x-xss-protection\": \"0\"}\n    at Object.toHaveProperty (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/system.test.js:100:32)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"System API Tests CORS should include CORS headers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should include CORS headers"},{"ancestorTitles":["System API Tests","CORS"],"duration":6,"failureDetails":[{"matcherResult":{"message":"expect(received).toHaveProperty(path)\n\nExpected path: \"access-control-allow-headers\"\nReceived path: []\n\nReceived value: {\"access-control-allow-credentials\": \"true\", \"access-control-allow-methods\": \"GET,HEAD,PUT,PATCH,POST,DELETE\", \"access-control-allow-origin\": \"http://localhost:3000\", \"connection\": \"close\", \"content-length\": \"0\", \"content-security-policy\": \"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests\", \"cross-origin-opener-policy\": \"same-origin\", \"cross-origin-resource-policy\": \"cross-origin\", \"date\": \"Thu, 24 Jul 2025 05:16:02 GMT\", \"origin-agent-cluster\": \"?1\", \"referrer-policy\": \"no-referrer\", \"strict-transport-security\": \"max-age=15552000; includeSubDomains\", \"vary\": \"Origin, Access-Control-Request-Headers\", \"x-content-type-options\": \"nosniff\", \"x-dns-prefetch-control\": \"off\", \"x-download-options\": \"noopen\", \"x-frame-options\": \"SAMEORIGIN\", \"x-permitted-cross-domain-policies\": \"none\", \"x-xss-protection\": \"0\"}","pass":false}}],"failureMessages":["Error: expect(received).toHaveProperty(path)\n\nExpected path: \"access-control-allow-headers\"\nReceived path: []\n\nReceived value: {\"access-control-allow-credentials\": \"true\", \"access-control-allow-methods\": \"GET,HEAD,PUT,PATCH,POST,DELETE\", \"access-control-allow-origin\": \"http://localhost:3000\", \"connection\": \"close\", \"content-length\": \"0\", \"content-security-policy\": \"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests\", \"cross-origin-opener-policy\": \"same-origin\", \"cross-origin-resource-policy\": \"cross-origin\", \"date\": \"Thu, 24 Jul 2025 05:16:02 GMT\", \"origin-agent-cluster\": \"?1\", \"referrer-policy\": \"no-referrer\", \"strict-transport-security\": \"max-age=15552000; includeSubDomains\", \"vary\": \"Origin, Access-Control-Request-Headers\", \"x-content-type-options\": \"nosniff\", \"x-dns-prefetch-control\": \"off\", \"x-download-options\": \"noopen\", \"x-frame-options\": \"SAMEORIGIN\", \"x-permitted-cross-domain-policies\": \"none\", \"x-xss-protection\": \"0\"}\n    at Object.toHaveProperty (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/system.test.js:111:32)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"System API Tests CORS should handle preflight requests","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should handle preflight requests"},{"ancestorTitles":["System API Tests","Rate Limiting"],"duration":43,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests Rate Limiting should handle rate limiting headers","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"passed","title":"should handle rate limiting headers"},{"ancestorTitles":["System API Tests","Error Handling"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests Error Handling should handle malformed JSON","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle malformed JSON"},{"ancestorTitles":["System API Tests","Error Handling"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"System API Tests Error Handling should handle missing required fields","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle missing required fields"}],"endTime":1753334163056,"message":"  ● System API Tests › GET /api/system/info › should return system info with admin role\n\n    expect(received).toHaveProperty(path)\n\n    Expected path: \"uptime\"\n    Received path: []\n\n    Received value: {\"cpu\": {\"system\": 216249, \"user\": 1045821}, \"memory\": {\"arrayBuffers\": 6042127, \"external\": 7522004, \"heapTotal\": 91668480, \"heapUsed\": 60995488, \"rss\": 145276928}, \"nodeVersion\": \"v18.20.4\", \"version\": \"1.0.0\"}\n\n      47 |       expect(response.body.data).toHaveProperty('version');\n      48 |       expect(response.body.data).toHaveProperty('nodeVersion');\n    > 49 |       expect(response.body.data).toHaveProperty('uptime');\n         |                                  ^\n      50 |       expect(response.body.data).toHaveProperty('memory');\n      51 |     });\n      52 |\n\n      at Object.toHaveProperty (api/system.test.js:49:34)\n\n  ● System API Tests › GET /api/system/info › should fail without admin role\n\n    expected 403 \"Forbidden\", got 200 \"OK\"\n\n      55 |         .get('/api/system/info')\n      56 |         .set(authHeader(viewerToken))\n    > 57 |         .expect(403);\n         |          ^\n      58 |\n      59 |       expect(response.body.success).toBe(false);\n      60 |     });\n\n      at Object.expect (api/system.test.js:57:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● System API Tests › CORS › should include CORS headers\n\n    expect(received).toHaveProperty(path)\n\n    Expected path: \"access-control-allow-origin\"\n    Received path: []\n\n    Received value: {\"access-control-allow-credentials\": \"true\", \"connection\": \"close\", \"content-length\": \"98\", \"content-security-policy\": \"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests\", \"content-type\": \"application/json; charset=utf-8\", \"cross-origin-opener-policy\": \"same-origin\", \"cross-origin-resource-policy\": \"cross-origin\", \"date\": \"Thu, 24 Jul 2025 05:16:02 GMT\", \"etag\": \"W/\\\"62-Or/A1FwrWLKU5YgohZyOZBYJWzk\\\"\", \"origin-agent-cluster\": \"?1\", \"referrer-policy\": \"no-referrer\", \"strict-transport-security\": \"max-age=15552000; includeSubDomains\", \"vary\": \"Origin, Accept-Encoding\", \"x-content-type-options\": \"nosniff\", \"x-dns-prefetch-control\": \"off\", \"x-download-options\": \"noopen\", \"x-frame-options\": \"SAMEORIGIN\", \"x-permitted-cross-domain-policies\": \"none\", \"x-xss-protection\": \"0\"}\n\n       98 |         .expect(200);\n       99 |\n    > 100 |       expect(response.headers).toHaveProperty('access-control-allow-origin');\n          |                                ^\n      101 |     });\n      102 |\n      103 |     it('should handle preflight requests', async () => {\n\n      at Object.toHaveProperty (api/system.test.js:100:32)\n\n  ● System API Tests › CORS › should handle preflight requests\n\n    expect(received).toHaveProperty(path)\n\n    Expected path: \"access-control-allow-headers\"\n    Received path: []\n\n    Received value: {\"access-control-allow-credentials\": \"true\", \"access-control-allow-methods\": \"GET,HEAD,PUT,PATCH,POST,DELETE\", \"access-control-allow-origin\": \"http://localhost:3000\", \"connection\": \"close\", \"content-length\": \"0\", \"content-security-policy\": \"default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests\", \"cross-origin-opener-policy\": \"same-origin\", \"cross-origin-resource-policy\": \"cross-origin\", \"date\": \"Thu, 24 Jul 2025 05:16:02 GMT\", \"origin-agent-cluster\": \"?1\", \"referrer-policy\": \"no-referrer\", \"strict-transport-security\": \"max-age=15552000; includeSubDomains\", \"vary\": \"Origin, Access-Control-Request-Headers\", \"x-content-type-options\": \"nosniff\", \"x-dns-prefetch-control\": \"off\", \"x-download-options\": \"noopen\", \"x-frame-options\": \"SAMEORIGIN\", \"x-permitted-cross-domain-policies\": \"none\", \"x-xss-protection\": \"0\"}\n\n      109 |\n      110 |       expect(response.headers).toHaveProperty('access-control-allow-methods');\n    > 111 |       expect(response.headers).toHaveProperty('access-control-allow-headers');\n          |                                ^\n      112 |     });\n      113 |   });\n      114 |\n\n      at Object.toHaveProperty (api/system.test.js:111:32)\n","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/system.test.js","startTime":1753334160781,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Health Check API","GET /health"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Health Check API GET /health should return health status","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should return health status"},{"ancestorTitles":["Health Check API","GET /"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Health Check API GET / should return API information","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return API information"}],"endTime":1753334163159,"message":"","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/health.test.js","startTime":1753334162936,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Contacts API Tests","POST /api/contacts"],"duration":44,"failureDetails":[{}],"failureMessages":["Error: expected 201 \"Created\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:31:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests POST /api/contacts should submit contact form without authentication","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should submit contact form without authentication"},{"ancestorTitles":["Contacts API Tests","POST /api/contacts"],"duration":10,"failureDetails":[{}],"failureMessages":["Error: expected 201 \"Created\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:49:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests POST /api/contacts should submit contact with project reference","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should submit contact with project reference"},{"ancestorTitles":["Contacts API Tests","POST /api/contacts"],"duration":9,"failureDetails":[{"matcherResult":{"message":"expect(received).toContain(expected) // indexOf\n\nExpected value:  \"email\"\nReceived object: {\"code\": \"VALIDATION_ERROR\", \"details\": \"Please check the errors field for details\"}","pass":false}}],"failureMessages":["Error: expect(received).toContain(expected) // indexOf\n\nExpected value:  \"email\"\nReceived object: {\"code\": \"VALIDATION_ERROR\", \"details\": \"Please check the errors field for details\"}\n    at Object.toContain (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:61:35)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests POST /api/contacts should fail with invalid email","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should fail with invalid email"},{"ancestorTitles":["Contacts API Tests","POST /api/contacts"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Contacts API Tests POST /api/contacts should fail with empty message","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail with empty message"},{"ancestorTitles":["Contacts API Tests","POST /api/contacts"],"duration":37,"failureDetails":[],"failureMessages":[],"fullName":"Contacts API Tests POST /api/contacts should handle rate limiting","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle rate limiting"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts"],"duration":14,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:120:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts should get all contacts with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get all contacts with admin role"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts"],"duration":13,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:133:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts should get contacts with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get contacts with editor role"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Contacts API Tests GET /api/contacts should fail without authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail without authentication"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts"],"duration":10,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:150:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts should filter contacts by read status","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should filter contacts by read status"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts"],"duration":7,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:162:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts should support pagination","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should support pagination"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts/statistics"],"duration":6,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:175:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts/statistics should get contact statistics with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get contact statistics with admin role"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts/statistics"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:189:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts/statistics should fail with viewer role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with viewer role"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts/:id"],"duration":11,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:200:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts/:id should get contact by id","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get contact by id"},{"ancestorTitles":["Contacts API Tests","GET /api/contacts/:id"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 404 \"Not Found\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:213:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Contacts API Tests GET /api/contacts/:id should return 404 for non-existent contact","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return 404 for non-existent contact"},{"ancestorTitles":["Contacts API Tests","PUT /api/contacts/:id/read"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:230:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests PUT /api/contacts/:id/read should mark contact as read","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should mark contact as read"},{"ancestorTitles":["Contacts API Tests","PUT /api/contacts/:id/read"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:230:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests PUT /api/contacts/:id/read should fail with viewer role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with viewer role"},{"ancestorTitles":["Contacts API Tests","PUT /api/contacts/bulk-read"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:265:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests PUT /api/contacts/bulk-read should mark multiple contacts as read","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should mark multiple contacts as read"},{"ancestorTitles":["Contacts API Tests","PUT /api/contacts/bulk-read"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:265:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests PUT /api/contacts/bulk-read should fail without ids array","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without ids array"},{"ancestorTitles":["Contacts API Tests","PUT /api/contacts/:id/reply"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:302:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests PUT /api/contacts/:id/reply should reply to contact","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reply to contact"},{"ancestorTitles":["Contacts API Tests","PUT /api/contacts/:id/reply"],"duration":4,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:302:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests PUT /api/contacts/:id/reply should fail with empty reply","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with empty reply"},{"ancestorTitles":["Contacts API Tests","DELETE /api/contacts/:id"],"duration":5,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:344:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests DELETE /api/contacts/:id should delete contact with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should delete contact with admin role"},{"ancestorTitles":["Contacts API Tests","DELETE /api/contacts/:id"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:344:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests DELETE /api/contacts/:id should fail with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with editor role"},{"ancestorTitles":["Contacts API Tests","POST /api/contacts/bulk-delete"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:384:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests POST /api/contacts/bulk-delete should delete multiple contacts","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should delete multiple contacts"},{"ancestorTitles":["Contacts API Tests","POST /api/contacts/bulk-delete"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js:384:44)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Contacts API Tests POST /api/contacts/bulk-delete should fail without admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without admin role"}],"endTime":1753334163293,"message":"  ● Contacts API Tests › POST /api/contacts › should submit contact form without authentication\n\n    expected 201 \"Created\", got 500 \"Internal Server Error\"\n\n      29 |         .post('/api/contacts')\n      30 |         .send(testContacts.valid)\n    > 31 |         .expect(201);\n         |          ^\n      32 |\n      33 |       expect(response.body.success).toBe(true);\n      34 |       expect(response.body.data).toHaveProperty('id');\n\n      at Object.expect (api/contacts.test.js:31:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › POST /api/contacts › should submit contact with project reference\n\n    expected 201 \"Created\", got 500 \"Internal Server Error\"\n\n      47 |         .post('/api/contacts')\n      48 |         .send(contactWithProject)\n    > 49 |         .expect(201);\n         |          ^\n      50 |\n      51 |       expect(response.body.success).toBe(true);\n      52 |     });\n\n      at Object.expect (api/contacts.test.js:49:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › POST /api/contacts › should fail with invalid email\n\n    expect(received).toContain(expected) // indexOf\n\n    Expected value:  \"email\"\n    Received object: {\"code\": \"VALIDATION_ERROR\", \"details\": \"Please check the errors field for details\"}\n\n      59 |\n      60 |       expect(response.body.success).toBe(false);\n    > 61 |       expect(response.body.error).toContain('email');\n         |                                   ^\n      62 |     });\n      63 |\n      64 |     it('should fail with empty message', async () => {\n\n      at Object.toContain (api/contacts.test.js:61:35)\n\n  ● Contacts API Tests › GET /api/contacts › should get all contacts with admin role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      118 |         .get('/api/contacts')\n      119 |         .set(authHeader(adminToken))\n    > 120 |         .expect(200);\n          |          ^\n      121 |\n      122 |       expect(response.body.success).toBe(true);\n      123 |       expect(response.body.data).toHaveProperty('contacts');\n\n      at Object.expect (api/contacts.test.js:120:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts › should get contacts with editor role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      131 |         .get('/api/contacts')\n      132 |         .set(authHeader(editorToken))\n    > 133 |         .expect(200);\n          |          ^\n      134 |\n      135 |       expect(response.body.success).toBe(true);\n      136 |     });\n\n      at Object.expect (api/contacts.test.js:133:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts › should filter contacts by read status\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      148 |         .get('/api/contacts?isRead=false')\n      149 |         .set(authHeader(adminToken))\n    > 150 |         .expect(200);\n          |          ^\n      151 |\n      152 |       expect(response.body.success).toBe(true);\n      153 |       response.body.data.contacts.forEach(contact => {\n\n      at Object.expect (api/contacts.test.js:150:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts › should support pagination\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      160 |         .get('/api/contacts?page=1&limit=2')\n      161 |         .set(authHeader(adminToken))\n    > 162 |         .expect(200);\n          |          ^\n      163 |\n      164 |       expect(response.body.success).toBe(true);\n      165 |       expect(response.body.data.contacts.length).toBeLessThanOrEqual(2);\n\n      at Object.expect (api/contacts.test.js:162:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts/statistics › should get contact statistics with admin role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      173 |         .get('/api/contacts/statistics')\n      174 |         .set(authHeader(adminToken))\n    > 175 |         .expect(200);\n          |          ^\n      176 |\n      177 |       expect(response.body.success).toBe(true);\n      178 |       expect(response.body.data).toHaveProperty('total');\n\n      at Object.expect (api/contacts.test.js:175:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts/statistics › should fail with viewer role\n\n    expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n\n      187 |         .get('/api/contacts/statistics')\n      188 |         .set(authHeader(viewerToken))\n    > 189 |         .expect(403);\n          |          ^\n      190 |\n      191 |       expect(response.body.success).toBe(false);\n      192 |     });\n\n      at Object.expect (api/contacts.test.js:189:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts/:id › should get contact by id\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      198 |         .get(`/api/contacts/${testContactId}`)\n      199 |         .set(authHeader(adminToken))\n    > 200 |         .expect(200);\n          |          ^\n      201 |\n      202 |       expect(response.body.success).toBe(true);\n      203 |       expect(response.body.data.id).toBe(testContactId);\n\n      at Object.expect (api/contacts.test.js:200:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › GET /api/contacts/:id › should return 404 for non-existent contact\n\n    expected 404 \"Not Found\", got 500 \"Internal Server Error\"\n\n      211 |         .get('/api/contacts/99999')\n      212 |         .set(authHeader(adminToken))\n    > 213 |         .expect(404);\n          |          ^\n      214 |\n      215 |       expect(response.body.success).toBe(false);\n      216 |     });\n\n      at Object.expect (api/contacts.test.js:213:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Contacts API Tests › PUT /api/contacts/:id/read › should mark contact as read\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      228 |         });\n      229 |       \n    > 230 |       unreadContactId = response.body.data.id;\n          |                                            ^\n      231 |     });\n      232 |\n      233 |     it('should mark contact as read', async () => {\n\n      at Object.id (api/contacts.test.js:230:44)\n\n  ● Contacts API Tests › PUT /api/contacts/:id/read › should fail with viewer role\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      228 |         });\n      229 |       \n    > 230 |       unreadContactId = response.body.data.id;\n          |                                            ^\n      231 |     });\n      232 |\n      233 |     it('should mark contact as read', async () => {\n\n      at Object.id (api/contacts.test.js:230:44)\n\n  ● Contacts API Tests › PUT /api/contacts/bulk-read › should mark multiple contacts as read\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      263 |             name: `Bulk Contact ${i}`\n      264 |           });\n    > 265 |         contactIds.push(response.body.data.id);\n          |                                            ^\n      266 |       }\n      267 |     });\n      268 |\n\n      at Object.id (api/contacts.test.js:265:44)\n\n  ● Contacts API Tests › PUT /api/contacts/bulk-read › should fail without ids array\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      263 |             name: `Bulk Contact ${i}`\n      264 |           });\n    > 265 |         contactIds.push(response.body.data.id);\n          |                                            ^\n      266 |       }\n      267 |     });\n      268 |\n\n      at Object.id (api/contacts.test.js:265:44)\n\n  ● Contacts API Tests › PUT /api/contacts/:id/reply › should reply to contact\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      300 |         });\n      301 |       \n    > 302 |       contactToReply = response.body.data.id;\n          |                                           ^\n      303 |     });\n      304 |\n      305 |     it('should reply to contact', async () => {\n\n      at Object.id (api/contacts.test.js:302:43)\n\n  ● Contacts API Tests › PUT /api/contacts/:id/reply › should fail with empty reply\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      300 |         });\n      301 |       \n    > 302 |       contactToReply = response.body.data.id;\n          |                                           ^\n      303 |     });\n      304 |\n      305 |     it('should reply to contact', async () => {\n\n      at Object.id (api/contacts.test.js:302:43)\n\n  ● Contacts API Tests › DELETE /api/contacts/:id › should delete contact with admin role\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      342 |         });\n      343 |       \n    > 344 |       contactToDelete = response.body.data.id;\n          |                                            ^\n      345 |     });\n      346 |\n      347 |     it('should delete contact with admin role', async () => {\n\n      at Object.id (api/contacts.test.js:344:44)\n\n  ● Contacts API Tests › DELETE /api/contacts/:id › should fail with editor role\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      342 |         });\n      343 |       \n    > 344 |       contactToDelete = response.body.data.id;\n          |                                            ^\n      345 |     });\n      346 |\n      347 |     it('should delete contact with admin role', async () => {\n\n      at Object.id (api/contacts.test.js:344:44)\n\n  ● Contacts API Tests › POST /api/contacts/bulk-delete › should delete multiple contacts\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      382 |             name: `Bulk Delete Contact ${i}`\n      383 |           });\n    > 384 |         contactIds.push(response.body.data.id);\n          |                                            ^\n      385 |       }\n      386 |     });\n      387 |\n\n      at Object.id (api/contacts.test.js:384:44)\n\n  ● Contacts API Tests › POST /api/contacts/bulk-delete › should fail without admin role\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      382 |             name: `Bulk Delete Contact ${i}`\n      383 |           });\n    > 384 |         contactIds.push(response.body.data.id);\n          |                                            ^\n      385 |       }\n      386 |     });\n      387 |\n\n      at Object.id (api/contacts.test.js:384:44)\n","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/contacts.test.js","startTime":1753334160795,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Auth API Tests","POST /api/auth/register"],"duration":152,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/register should register a new user successfully","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"should register a new user successfully"},{"ancestorTitles":["Auth API Tests","POST /api/auth/register"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/register should fail with duplicate username","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should fail with duplicate username"},{"ancestorTitles":["Auth API Tests","POST /api/auth/register"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/register should fail with invalid email","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should fail with invalid email"},{"ancestorTitles":["Auth API Tests","POST /api/auth/register"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/register should fail with weak password","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should fail with weak password"},{"ancestorTitles":["Auth API Tests","POST /api/auth/login"],"duration":97,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/login should login successfully with valid credentials","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should login successfully with valid credentials"},{"ancestorTitles":["Auth API Tests","POST /api/auth/login"],"duration":7,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 401 \"Unauthorized\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:111:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Auth API Tests POST /api/auth/login should login with email instead of username","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should login with email instead of username"},{"ancestorTitles":["Auth API Tests","POST /api/auth/login"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/login should fail with invalid credentials","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should fail with invalid credentials"},{"ancestorTitles":["Auth API Tests","POST /api/auth/login"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"Auth API Tests POST /api/auth/login should fail with non-existent user","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail with non-existent user"},{"ancestorTitles":["Auth API Tests","POST /api/auth/refresh"],"duration":5,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at Object.refreshToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:154:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests POST /api/auth/refresh should refresh token successfully","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should refresh token successfully"},{"ancestorTitles":["Auth API Tests","POST /api/auth/refresh"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at Object.refreshToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:154:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests POST /api/auth/refresh should fail with invalid refresh token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with invalid refresh token"},{"ancestorTitles":["Auth API Tests","POST /api/auth/refresh"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'refreshToken')\n    at Object.refreshToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:154:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests POST /api/auth/refresh should fail without refresh token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without refresh token"},{"ancestorTitles":["Auth API Tests","GET /api/auth/me"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:198:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests GET /api/auth/me should get current user info with valid token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get current user info with valid token"},{"ancestorTitles":["Auth API Tests","GET /api/auth/me"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:198:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests GET /api/auth/me should fail without token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without token"},{"ancestorTitles":["Auth API Tests","GET /api/auth/me"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:198:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests GET /api/auth/me should fail with invalid token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with invalid token"},{"ancestorTitles":["Auth API Tests","PUT /api/auth/change-password"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:243:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests PUT /api/auth/change-password should change password successfully","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should change password successfully"},{"ancestorTitles":["Auth API Tests","PUT /api/auth/change-password"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:243:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests PUT /api/auth/change-password should fail with wrong current password","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with wrong current password"},{"ancestorTitles":["Auth API Tests","PUT /api/auth/change-password"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:243:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests PUT /api/auth/change-password should fail with weak new password","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with weak new password"},{"ancestorTitles":["Auth API Tests","POST /api/auth/logout"],"duration":1,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'accessToken')\n    at Object.accessToken (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js:319:43)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Auth API Tests POST /api/auth/logout should logout successfully","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should logout successfully"}],"endTime":1753334163374,"message":"  ● Auth API Tests › POST /api/auth/login › should login with email instead of username\n\n    expected 200 \"OK\", got 401 \"Unauthorized\"\n\n      109 |           password: 'Test123!'\n      110 |         })\n    > 111 |         .expect(200);\n          |          ^\n      112 |\n      113 |       expect(response.body.success).toBe(true);\n      114 |       expect(response.body.data.user.username).toBe('testadmin');\n\n      at Object.expect (api/auth.test.js:111:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Auth API Tests › POST /api/auth/refresh › should refresh token successfully\n\n    TypeError: Cannot read properties of undefined (reading 'refreshToken')\n\n      152 |         });\n      153 |       \n    > 154 |       refreshToken = loginResponse.body.data.refreshToken;\n          |                                              ^\n      155 |     });\n      156 |\n      157 |     it('should refresh token successfully', async () => {\n\n      at Object.refreshToken (api/auth.test.js:154:46)\n\n  ● Auth API Tests › POST /api/auth/refresh › should fail with invalid refresh token\n\n    TypeError: Cannot read properties of undefined (reading 'refreshToken')\n\n      152 |         });\n      153 |       \n    > 154 |       refreshToken = loginResponse.body.data.refreshToken;\n          |                                              ^\n      155 |     });\n      156 |\n      157 |     it('should refresh token successfully', async () => {\n\n      at Object.refreshToken (api/auth.test.js:154:46)\n\n  ● Auth API Tests › POST /api/auth/refresh › should fail without refresh token\n\n    TypeError: Cannot read properties of undefined (reading 'refreshToken')\n\n      152 |         });\n      153 |       \n    > 154 |       refreshToken = loginResponse.body.data.refreshToken;\n          |                                              ^\n      155 |     });\n      156 |\n      157 |     it('should refresh token successfully', async () => {\n\n      at Object.refreshToken (api/auth.test.js:154:46)\n\n  ● Auth API Tests › GET /api/auth/me › should get current user info with valid token\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      196 |         });\n      197 |       \n    > 198 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      199 |     });\n      200 |\n      201 |     it('should get current user info with valid token', async () => {\n\n      at Object.accessToken (api/auth.test.js:198:43)\n\n  ● Auth API Tests › GET /api/auth/me › should fail without token\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      196 |         });\n      197 |       \n    > 198 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      199 |     });\n      200 |\n      201 |     it('should get current user info with valid token', async () => {\n\n      at Object.accessToken (api/auth.test.js:198:43)\n\n  ● Auth API Tests › GET /api/auth/me › should fail with invalid token\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      196 |         });\n      197 |       \n    > 198 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      199 |     });\n      200 |\n      201 |     it('should get current user info with valid token', async () => {\n\n      at Object.accessToken (api/auth.test.js:198:43)\n\n  ● Auth API Tests › PUT /api/auth/change-password › should change password successfully\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      241 |         });\n      242 |       \n    > 243 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      244 |     });\n      245 |\n      246 |     it('should change password successfully', async () => {\n\n      at Object.accessToken (api/auth.test.js:243:43)\n\n  ● Auth API Tests › PUT /api/auth/change-password › should fail with wrong current password\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      241 |         });\n      242 |       \n    > 243 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      244 |     });\n      245 |\n      246 |     it('should change password successfully', async () => {\n\n      at Object.accessToken (api/auth.test.js:243:43)\n\n  ● Auth API Tests › PUT /api/auth/change-password › should fail with weak new password\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      241 |         });\n      242 |       \n    > 243 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      244 |     });\n      245 |\n      246 |     it('should change password successfully', async () => {\n\n      at Object.accessToken (api/auth.test.js:243:43)\n\n  ● Auth API Tests › POST /api/auth/logout › should logout successfully\n\n    TypeError: Cannot read properties of undefined (reading 'accessToken')\n\n      317 |         });\n      318 |       \n    > 319 |       authToken = loginResponse.body.data.accessToken;\n          |                                           ^\n      320 |     });\n      321 |\n      322 |     it('should logout successfully', async () => {\n\n      at Object.accessToken (api/auth.test.js:319:43)\n","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/auth.test.js","startTime":1753334160782,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Tags API Tests","POST /api/tags"],"duration":88,"failureDetails":[{}],"failureMessages":["Error: expected 201 \"Created\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:33:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests POST /api/tags should create a new tag with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should create a new tag with admin role"},{"ancestorTitles":["Tags API Tests","POST /api/tags"],"duration":16,"failureDetails":[{}],"failureMessages":["Error: expected 201 \"Created\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:57:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests POST /api/tags should create tag with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should create tag with editor role"},{"ancestorTitles":["Tags API Tests","POST /api/tags"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"Tags API Tests POST /api/tags should fail without authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail without authentication"},{"ancestorTitles":["Tags API Tests","POST /api/tags"],"duration":15,"failureDetails":[{}],"failureMessages":["Error: expected 400 \"Bad Request\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:77:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests POST /api/tags should fail with duplicate tag name","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with duplicate tag name"},{"ancestorTitles":["Tags API Tests","POST /api/tags"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Tags API Tests POST /api/tags should fail with invalid category","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail with invalid category"},{"ancestorTitles":["Tags API Tests","GET /api/tags"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:113:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags should get all tags without authentication","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get all tags without authentication"},{"ancestorTitles":["Tags API Tests","GET /api/tags"],"duration":2,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:123:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags should filter tags by category","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should filter tags by category"},{"ancestorTitles":["Tags API Tests","GET /api/tags"],"duration":2,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:134:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags should limit number of tags returned","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should limit number of tags returned"},{"ancestorTitles":["Tags API Tests","GET /api/tags/popular"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:145:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags/popular should get popular tags","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get popular tags"},{"ancestorTitles":["Tags API Tests","GET /api/tags/popular"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:163:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags/popular should limit popular tags","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should limit popular tags"},{"ancestorTitles":["Tags API Tests","GET /api/tags/search"],"duration":2,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:174:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags/search should search tags by query","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should search tags by query"},{"ancestorTitles":["Tags API Tests","GET /api/tags/search"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:184:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags/search should return empty array for no matches","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return empty array for no matches"},{"ancestorTitles":["Tags API Tests","GET /api/tags/search"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Tags API Tests GET /api/tags/search should fail without search query","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail without search query"},{"ancestorTitles":["Tags API Tests","GET /api/tags/:identifier"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:203:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags/:identifier should get tag by identifier","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get tag by identifier"},{"ancestorTitles":["Tags API Tests","GET /api/tags/:identifier"],"duration":2,"failureDetails":[{}],"failureMessages":["Error: expected 404 \"Not Found\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:214:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests GET /api/tags/:identifier should return 404 for non-existent tag","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return 404 for non-existent tag"},{"ancestorTitles":["Tags API Tests","PUT /api/tags/:identifier"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:226:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests PUT /api/tags/:identifier should update tag with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should update tag with admin role"},{"ancestorTitles":["Tags API Tests","PUT /api/tags/:identifier"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:238:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests PUT /api/tags/:identifier should fail with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with editor role"},{"ancestorTitles":["Tags API Tests","PUT /api/tags/:identifier"],"duration":6,"failureDetails":[{}],"failureMessages":["Error: expected 400 \"Bad Request\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:259:10)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests PUT /api/tags/:identifier should fail when updating to duplicate name","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail when updating to duplicate name"},{"ancestorTitles":["Tags API Tests","POST /api/tags/merge"],"duration":4,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:280:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Tags API Tests POST /api/tags/merge should merge tags with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should merge tags with admin role"},{"ancestorTitles":["Tags API Tests","POST /api/tags/merge"],"duration":5,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:280:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Tags API Tests POST /api/tags/merge should fail without admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without admin role"},{"ancestorTitles":["Tags API Tests","POST /api/tags/merge"],"duration":5,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:280:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Tags API Tests POST /api/tags/merge should fail with invalid tag ids","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail with invalid tag ids"},{"ancestorTitles":["Tags API Tests","POST /api/tags/merge"],"duration":4,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'id')\n    at Object.id (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:280:46)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Tags API Tests POST /api/tags/merge should fail when merging tag with itself","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail when merging tag with itself"},{"ancestorTitles":["Tags API Tests","DELETE /api/tags/:identifier"],"duration":6,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'identifier')\n    at Object.identifier (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:365:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Tags API Tests DELETE /api/tags/:identifier should delete tag with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should delete tag with admin role"},{"ancestorTitles":["Tags API Tests","DELETE /api/tags/:identifier"],"duration":4,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'identifier')\n    at Object.identifier (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:365:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Tags API Tests DELETE /api/tags/:identifier should fail without admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without admin role"},{"ancestorTitles":["Tags API Tests","POST /api/tags/update-counts"],"duration":3,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:397:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests POST /api/tags/update-counts should update tag usage counts with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should update tag usage counts with admin role"},{"ancestorTitles":["Tags API Tests","POST /api/tags/update-counts"],"duration":2,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js:407:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Tags API Tests POST /api/tags/update-counts should fail without admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail without admin role"}],"endTime":1753334163380,"message":"  ● Tags API Tests › POST /api/tags › should create a new tag with admin role\n\n    expected 201 \"Created\", got 500 \"Internal Server Error\"\n\n      31 |         .set(authHeader(adminToken))\n      32 |         .send(testTags.valid)\n    > 33 |         .expect(201);\n         |          ^\n      34 |\n      35 |       expect(response.body.success).toBe(true);\n      36 |       expect(response.body.data).toHaveProperty('id');\n\n      at Object.expect (api/tags.test.js:33:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › POST /api/tags › should create tag with editor role\n\n    expected 201 \"Created\", got 500 \"Internal Server Error\"\n\n      55 |         .set(authHeader(editorToken))\n      56 |         .send(tagData)\n    > 57 |         .expect(201);\n         |          ^\n      58 |\n      59 |       expect(response.body.success).toBe(true);\n      60 |       expect(response.body.data.name).toBe(tagData.name);\n\n      at Object.expect (api/tags.test.js:57:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › POST /api/tags › should fail with duplicate tag name\n\n    expected 400 \"Bad Request\", got 500 \"Internal Server Error\"\n\n      75 |         .set(authHeader(adminToken))\n      76 |         .send(testTags.valid)\n    > 77 |         .expect(400);\n         |          ^\n      78 |\n      79 |       expect(response.body.success).toBe(false);\n      80 |       expect(response.body.error).toContain('already exists');\n\n      at Object.expect (api/tags.test.js:77:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags › should get all tags without authentication\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      111 |       const response = await request(app)\n      112 |         .get('/api/tags')\n    > 113 |         .expect(200);\n          |          ^\n      114 |\n      115 |       expect(response.body.success).toBe(true);\n      116 |       expect(Array.isArray(response.body.data)).toBe(true);\n\n      at Object.expect (api/tags.test.js:113:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags › should filter tags by category\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      121 |       const response = await request(app)\n      122 |         .get('/api/tags?category=style')\n    > 123 |         .expect(200);\n          |          ^\n      124 |\n      125 |       expect(response.body.success).toBe(true);\n      126 |       response.body.data.forEach(tag => {\n\n      at Object.expect (api/tags.test.js:123:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags › should limit number of tags returned\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      132 |       const response = await request(app)\n      133 |         .get('/api/tags?limit=5')\n    > 134 |         .expect(200);\n          |          ^\n      135 |\n      136 |       expect(response.body.success).toBe(true);\n      137 |       expect(response.body.data.length).toBeLessThanOrEqual(5);\n\n      at Object.expect (api/tags.test.js:134:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags/popular › should get popular tags\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      143 |       const response = await request(app)\n      144 |         .get('/api/tags/popular')\n    > 145 |         .expect(200);\n          |          ^\n      146 |\n      147 |       expect(response.body.success).toBe(true);\n      148 |       expect(Array.isArray(response.body.data)).toBe(true);\n\n      at Object.expect (api/tags.test.js:145:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags/popular › should limit popular tags\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      161 |       const response = await request(app)\n      162 |         .get('/api/tags/popular?limit=3')\n    > 163 |         .expect(200);\n          |          ^\n      164 |\n      165 |       expect(response.body.success).toBe(true);\n      166 |       expect(response.body.data.length).toBeLessThanOrEqual(3);\n\n      at Object.expect (api/tags.test.js:163:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags/search › should search tags by query\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      172 |       const response = await request(app)\n      173 |         .get('/api/tags/search?q=tag')\n    > 174 |         .expect(200);\n          |          ^\n      175 |\n      176 |       expect(response.body.success).toBe(true);\n      177 |       expect(Array.isArray(response.body.data)).toBe(true);\n\n      at Object.expect (api/tags.test.js:174:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags/search › should return empty array for no matches\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      182 |       const response = await request(app)\n      183 |         .get('/api/tags/search?q=nonexistenttagname')\n    > 184 |         .expect(200);\n          |          ^\n      185 |\n      186 |       expect(response.body.success).toBe(true);\n      187 |       expect(response.body.data).toEqual([]);\n\n      at Object.expect (api/tags.test.js:184:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags/:identifier › should get tag by identifier\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      201 |       const response = await request(app)\n      202 |         .get(`/api/tags/${testTagIdentifier}`)\n    > 203 |         .expect(200);\n          |          ^\n      204 |\n      205 |       expect(response.body.success).toBe(true);\n      206 |       expect(response.body.data.identifier).toBe(testTagIdentifier);\n\n      at Object.expect (api/tags.test.js:203:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › GET /api/tags/:identifier › should return 404 for non-existent tag\n\n    expected 404 \"Not Found\", got 500 \"Internal Server Error\"\n\n      212 |       const response = await request(app)\n      213 |         .get('/api/tags/non-existent-tag')\n    > 214 |         .expect(404);\n          |          ^\n      215 |\n      216 |       expect(response.body.success).toBe(false);\n      217 |     });\n\n      at Object.expect (api/tags.test.js:214:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › PUT /api/tags/:identifier › should update tag with admin role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      224 |         .set(authHeader(adminToken))\n      225 |         .send(testTags.update)\n    > 226 |         .expect(200);\n          |          ^\n      227 |\n      228 |       expect(response.body.success).toBe(true);\n      229 |       expect(response.body.data.nameEn).toBe(testTags.update.nameEn);\n\n      at Object.expect (api/tags.test.js:226:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › PUT /api/tags/:identifier › should fail with editor role\n\n    expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n\n      236 |         .set(authHeader(editorToken))\n      237 |         .send(testTags.update)\n    > 238 |         .expect(403);\n          |          ^\n      239 |\n      240 |       expect(response.body.success).toBe(false);\n      241 |     });\n\n      at Object.expect (api/tags.test.js:238:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › PUT /api/tags/:identifier › should fail when updating to duplicate name\n\n    expected 400 \"Bad Request\", got 500 \"Internal Server Error\"\n\n      257 |         .set(authHeader(adminToken))\n      258 |         .send({ name: 'anothertag' })\n    > 259 |         .expect(400);\n          |          ^\n      260 |\n      261 |       expect(response.body.success).toBe(false);\n      262 |       expect(response.body.error).toContain('already exists');\n\n      at Object.expect (api/tags.test.js:259:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › POST /api/tags/merge › should merge tags with admin role\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      278 |           category: 'style'\n      279 |         });\n    > 280 |       sourceTagId = sourceResponse.body.data.id;\n          |                                              ^\n      281 |\n      282 |       const targetResponse = await request(app)\n      283 |         .post('/api/tags')\n\n      at Object.id (api/tags.test.js:280:46)\n\n  ● Tags API Tests › POST /api/tags/merge › should fail without admin role\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      278 |           category: 'style'\n      279 |         });\n    > 280 |       sourceTagId = sourceResponse.body.data.id;\n          |                                              ^\n      281 |\n      282 |       const targetResponse = await request(app)\n      283 |         .post('/api/tags')\n\n      at Object.id (api/tags.test.js:280:46)\n\n  ● Tags API Tests › POST /api/tags/merge › should fail with invalid tag ids\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      278 |           category: 'style'\n      279 |         });\n    > 280 |       sourceTagId = sourceResponse.body.data.id;\n          |                                              ^\n      281 |\n      282 |       const targetResponse = await request(app)\n      283 |         .post('/api/tags')\n\n      at Object.id (api/tags.test.js:280:46)\n\n  ● Tags API Tests › POST /api/tags/merge › should fail when merging tag with itself\n\n    TypeError: Cannot read properties of undefined (reading 'id')\n\n      278 |           category: 'style'\n      279 |         });\n    > 280 |       sourceTagId = sourceResponse.body.data.id;\n          |                                              ^\n      281 |\n      282 |       const targetResponse = await request(app)\n      283 |         .post('/api/tags')\n\n      at Object.id (api/tags.test.js:280:46)\n\n  ● Tags API Tests › DELETE /api/tags/:identifier › should delete tag with admin role\n\n    TypeError: Cannot read properties of undefined (reading 'identifier')\n\n      363 |         });\n      364 |       \n    > 365 |       tagToDelete = response.body.data.identifier;\n          |                                        ^\n      366 |     });\n      367 |\n      368 |     it('should delete tag with admin role', async () => {\n\n      at Object.identifier (api/tags.test.js:365:40)\n\n  ● Tags API Tests › DELETE /api/tags/:identifier › should fail without admin role\n\n    TypeError: Cannot read properties of undefined (reading 'identifier')\n\n      363 |         });\n      364 |       \n    > 365 |       tagToDelete = response.body.data.identifier;\n          |                                        ^\n      366 |     });\n      367 |\n      368 |     it('should delete tag with admin role', async () => {\n\n      at Object.identifier (api/tags.test.js:365:40)\n\n  ● Tags API Tests › POST /api/tags/update-counts › should update tag usage counts with admin role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      395 |         .post('/api/tags/update-counts')\n      396 |         .set(authHeader(adminToken))\n    > 397 |         .expect(200);\n          |          ^\n      398 |\n      399 |       expect(response.body.success).toBe(true);\n      400 |       expect(response.body.message).toContain('updated');\n\n      at Object.expect (api/tags.test.js:397:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Tags API Tests › POST /api/tags/update-counts › should fail without admin role\n\n    expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n\n      405 |         .post('/api/tags/update-counts')\n      406 |         .set(authHeader(editorToken))\n    > 407 |         .expect(403);\n          |          ^\n      408 |\n      409 |       expect(response.body.success).toBe(false);\n      410 |     });\n\n      at Object.expect (api/tags.test.js:407:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/tags.test.js","startTime":1753334160768,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Projects API Tests","POST /api/projects"],"duration":109,"failureDetails":[{}],"failureMessages":["Error: expected 201 \"Created\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:36:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests POST /api/projects should create a new project with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should create a new project with admin role"},{"ancestorTitles":["Projects API Tests","POST /api/projects"],"duration":67,"failureDetails":[{}],"failureMessages":["Error: expected 201 \"Created\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:60:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests POST /api/projects should create a project with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should create a project with editor role"},{"ancestorTitles":["Projects API Tests","POST /api/projects"],"duration":16,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:71:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests POST /api/projects should fail to create project with viewer role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail to create project with viewer role"},{"ancestorTitles":["Projects API Tests","POST /api/projects"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests POST /api/projects should fail without authentication","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail without authentication"},{"ancestorTitles":["Projects API Tests","POST /api/projects"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests POST /api/projects should fail with invalid project data","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should fail with invalid project data"},{"ancestorTitles":["Projects API Tests","GET /api/projects"],"duration":13,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeGreaterThan(expected)\n\nExpected: > 0\nReceived:   0","pass":false}}],"failureMessages":["Error: expect(received).toBeGreaterThan(expected)\n\nExpected: > 0\nReceived:   0\n    at Object.toBeGreaterThan (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:128:47)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Projects API Tests GET /api/projects should get all projects without authentication","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"failed","title":"should get all projects without authentication"},{"ancestorTitles":["Projects API Tests","GET /api/projects"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests GET /api/projects should filter projects by type","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should filter projects by type"},{"ancestorTitles":["Projects API Tests","GET /api/projects"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests GET /api/projects should filter projects by status","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should filter projects by status"},{"ancestorTitles":["Projects API Tests","GET /api/projects"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests GET /api/projects should support pagination","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should support pagination"},{"ancestorTitles":["Projects API Tests","GET /api/projects"],"duration":5,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeGreaterThan(expected)\n\nExpected: > 0\nReceived:   0","pass":false}}],"failureMessages":["Error: expect(received).toBeGreaterThan(expected)\n\nExpected: > 0\nReceived:   0\n    at Object.toBeGreaterThan (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:170:47)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Projects API Tests GET /api/projects should search projects by keyword","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should search projects by keyword"},{"ancestorTitles":["Projects API Tests","GET /api/projects/featured"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests GET /api/projects/featured should get featured projects","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should get featured projects"},{"ancestorTitles":["Projects API Tests","GET /api/projects/:identifier"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 404 \"Not Found\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:193:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests GET /api/projects/:identifier should get project by identifier","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get project by identifier"},{"ancestorTitles":["Projects API Tests","GET /api/projects/:identifier"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests GET /api/projects/:identifier should return 404 for non-existent project","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return 404 for non-existent project"},{"ancestorTitles":["Projects API Tests","PUT /api/projects/:identifier"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:217:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests PUT /api/projects/:identifier should update project with admin role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should update project with admin role"},{"ancestorTitles":["Projects API Tests","PUT /api/projects/:identifier"],"duration":5,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:234:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests PUT /api/projects/:identifier should update project with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should update project with editor role"},{"ancestorTitles":["Projects API Tests","PUT /api/projects/:identifier"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:244:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests PUT /api/projects/:identifier should fail to update with viewer role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail to update with viewer role"},{"ancestorTitles":["Projects API Tests","PATCH /api/projects/:identifier/status"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:256:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests PATCH /api/projects/:identifier/status should update project status","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should update project status"},{"ancestorTitles":["Projects API Tests","PATCH /api/projects/:identifier/status"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests PATCH /api/projects/:identifier/status should fail with invalid status","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should fail with invalid status"},{"ancestorTitles":["Projects API Tests","POST /api/projects/:identifier/feature"],"duration":4,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:279:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests POST /api/projects/:identifier/feature should toggle featured status","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should toggle featured status"},{"ancestorTitles":["Projects API Tests","Project Images API"],"duration":0,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'on')\n    at Test.on [as attach] (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/superagent/src/node/index.js:262:12)\n    at Object.attach (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:327:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)"],"fullName":"Projects API Tests Project Images API should upload project image","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should upload project image"},{"ancestorTitles":["Projects API Tests","Project Images API"],"duration":13,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:341:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests Project Images API should get project images","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should get project images"},{"ancestorTitles":["Projects API Tests","GET /api/projects/:identifier/related"],"duration":4,"failureDetails":[{"matcherResult":{"actual":false,"expected":true,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: true\nReceived: false","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: true\nReceived: false\n    at Object.toBe (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:355:49)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)"],"fullName":"Projects API Tests GET /api/projects/:identifier/related should get related projects","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should get related projects"},{"ancestorTitles":["Projects API Tests","DELETE /api/projects/:identifier"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"Projects API Tests DELETE /api/projects/:identifier should delete project with admin role","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should delete project with admin role"},{"ancestorTitles":["Projects API Tests","DELETE /api/projects/:identifier"],"duration":11,"failureDetails":[{}],"failureMessages":["Error: expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n    at Object.expect (/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js:386:10)\n    at Promise.then.completed (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:121:9)\n    at run (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/runTest.js:444:34)\n    at Object.worker (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/jest-runner/build/testWorker.js:106:12)\n----\n    at Test._assertStatus (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:252:14)\n    at /Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/Users/hanfourhuang/Projects/ZeYang/backend/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:631:28)\n    at Server.emit (node:events:517:28)\n    at emitCloseNT (node:net:2221:8)\n    at processTicksAndRejections (node:internal/process/task_queues:81:21)"],"fullName":"Projects API Tests DELETE /api/projects/:identifier should fail to delete with editor role","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should fail to delete with editor role"}],"endTime":1753334163381,"message":"  ● Projects API Tests › POST /api/projects › should create a new project with admin role\n\n    expected 201 \"Created\", got 500 \"Internal Server Error\"\n\n      34 |         .set(authHeader(adminToken))\n      35 |         .send(testProjects.valid)\n    > 36 |         .expect(201);\n         |          ^\n      37 |\n      38 |       expect(response.body.success).toBe(true);\n      39 |       expect(response.body.data).toHaveProperty('project');\n\n      at Object.expect (api/projects.test.js:36:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › POST /api/projects › should create a project with editor role\n\n    expected 201 \"Created\", got 500 \"Internal Server Error\"\n\n      58 |         .set(authHeader(editorToken))\n      59 |         .send(projectData)\n    > 60 |         .expect(201);\n         |          ^\n      61 |\n      62 |       expect(response.body.success).toBe(true);\n      63 |       expect(response.body.data.project.name).toBe('Editor Project');\n\n      at Object.expect (api/projects.test.js:60:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › POST /api/projects › should fail to create project with viewer role\n\n    expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n\n      69 |         .set(authHeader(viewerToken))\n      70 |         .send(testProjects.valid)\n    > 71 |         .expect(403);\n         |          ^\n      72 |\n      73 |       expect(response.body.success).toBe(false);\n      74 |     });\n\n      at Object.expect (api/projects.test.js:71:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › GET /api/projects › should get all projects without authentication\n\n    expect(received).toBeGreaterThan(expected)\n\n    Expected: > 0\n    Received:   0\n\n      126 |       expect(response.body.data).toHaveProperty('pagination');\n      127 |       expect(Array.isArray(response.body.data.items)).toBe(true);\n    > 128 |       expect(response.body.data.items.length).toBeGreaterThan(0);\n          |                                               ^\n      129 |     });\n      130 |\n      131 |     it('should filter projects by type', async () => {\n\n      at Object.toBeGreaterThan (api/projects.test.js:128:47)\n\n  ● Projects API Tests › GET /api/projects › should search projects by keyword\n\n    expect(received).toBeGreaterThan(expected)\n\n    Expected: > 0\n    Received:   0\n\n      168 |\n      169 |       expect(response.body.success).toBe(true);\n    > 170 |       expect(response.body.data.items.length).toBeGreaterThan(0);\n          |                                               ^\n      171 |     });\n      172 |   });\n      173 |\n\n      at Object.toBeGreaterThan (api/projects.test.js:170:47)\n\n  ● Projects API Tests › GET /api/projects/:identifier › should get project by identifier\n\n    expected 200 \"OK\", got 404 \"Not Found\"\n\n      191 |       const response = await request(app)\n      192 |         .get(`/api/projects/${testProjectIdentifier}`)\n    > 193 |         .expect(200);\n          |          ^\n      194 |\n      195 |       expect(response.body.success).toBe(true);\n      196 |       expect(response.body.data).toHaveProperty('project');\n\n      at Object.expect (api/projects.test.js:193:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › PUT /api/projects/:identifier › should update project with admin role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      215 |         .set(authHeader(adminToken))\n      216 |         .send(testProjects.update)\n    > 217 |         .expect(200);\n          |          ^\n      218 |\n      219 |       expect(response.body.success).toBe(true);\n      220 |       expect(response.body.data).toHaveProperty('project');\n\n      at Object.expect (api/projects.test.js:217:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › PUT /api/projects/:identifier › should update project with editor role\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      232 |         .set(authHeader(editorToken))\n      233 |         .send(updateData)\n    > 234 |         .expect(200);\n          |          ^\n      235 |\n      236 |       expect(response.body.success).toBe(true);\n      237 |     });\n\n      at Object.expect (api/projects.test.js:234:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › PUT /api/projects/:identifier › should fail to update with viewer role\n\n    expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n\n      242 |         .set(authHeader(viewerToken))\n      243 |         .send(testProjects.update)\n    > 244 |         .expect(403);\n          |          ^\n      245 |\n      246 |       expect(response.body.success).toBe(false);\n      247 |     });\n\n      at Object.expect (api/projects.test.js:244:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › PATCH /api/projects/:identifier/status › should update project status\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      254 |         .set(authHeader(adminToken))\n      255 |         .send({ status: 'completed' })\n    > 256 |         .expect(200);\n          |          ^\n      257 |\n      258 |       expect(response.body.success).toBe(true);\n      259 |       expect(response.body.message).toBeDefined();\n\n      at Object.expect (api/projects.test.js:256:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › POST /api/projects/:identifier/feature › should toggle featured status\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      277 |         .post(`/api/projects/${testProjectIdentifier}/feature`)\n      278 |         .set(authHeader(adminToken))\n    > 279 |         .expect(200);\n          |          ^\n      280 |\n      281 |       expect(response.body.success).toBe(true);\n      282 |       expect(response.body.data.isFeatured).toBeTruthy();\n\n      at Object.expect (api/projects.test.js:279:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › Project Images API › should upload project image\n\n    TypeError: Cannot read properties of undefined (reading 'on')\n\n      325 |         .post(`/api/projects/${testProjectIdentifier}/images`)\n      326 |         .set(authHeader(adminToken))\n    > 327 |         .attach('images', testImagePath)\n          |          ^\n      328 |         .field('alt', 'Test image')\n      329 |         .field('altEn', 'Test image')\n      330 |         .expect(201);\n\n      at Test.on [as attach] (../node_modules/superagent/src/node/index.js:262:12)\n      at Object.attach (api/projects.test.js:327:10)\n\n  ● Projects API Tests › Project Images API › should get project images\n\n    expected 200 \"OK\", got 500 \"Internal Server Error\"\n\n      339 |         .get(`/api/projects/${testProjectIdentifier}/images`)\n      340 |         .set(authHeader(adminToken))\n    > 341 |         .expect(200);\n          |          ^\n      342 |\n      343 |       expect(response.body.success).toBe(true);\n      344 |       expect(Array.isArray(response.body.data)).toBe(true);\n\n      at Object.expect (api/projects.test.js:341:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n\n  ● Projects API Tests › GET /api/projects/:identifier/related › should get related projects\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: false\n\n      353 |\n      354 |       expect(response.body.success).toBe(true);\n    > 355 |       expect(Array.isArray(response.body.data)).toBe(true);\n          |                                                 ^\n      356 |     });\n      357 |   });\n      358 |\n\n      at Object.toBe (api/projects.test.js:355:49)\n\n  ● Projects API Tests › DELETE /api/projects/:identifier › should fail to delete with editor role\n\n    expected 403 \"Forbidden\", got 500 \"Internal Server Error\"\n\n      384 |         .delete(`/api/projects/${projectToDelete.identifier}`)\n      385 |         .set(authHeader(editorToken))\n    > 386 |         .expect(403);\n          |          ^\n      387 |\n      388 |       expect(response.body.success).toBe(false);\n      389 |     });\n\n      at Object.expect (api/projects.test.js:386:10)\n      ----\n      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)\n      at ../node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (../node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)\n","name":"/Users/hanfourhuang/Projects/ZeYang/backend/tests/api/projects.test.js","startTime":1753334160803,"status":"failed","summary":""}],"wasInterrupted":false}
