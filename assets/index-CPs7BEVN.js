import{r as n,j as t,M as ie,N as le,R as oe}from"./index-By57yhN3.js";import{p as J}from"./project.service-zsHHG8Aw.js";import{g as z}from"./image-CG6tEh5z.js";import{P as ce}from"./PageBanner-h9Zt4JHM.js";function de({title:e,titleId:s,...x},l){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},x),e?n.createElement("title",{id:s},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const ue=n.forwardRef(de),Y=({images:e,config:s,className:x="",onSlideChange:l})=>{const[r,h]=n.useState(0),[o,u]=n.useState(!1),[d,w]=n.useState(null),[p,m]=n.useState({}),[N,$]=n.useState({}),[_,S]=n.useState(null),[v,P]=n.useState(null),[i,g]=n.useState(null),c=(r+1)%e.length,f=r===0?e.length-1:r-1,b=s.transitionDuration||300,E=s.container.alignItems||"start",X=s.container.gap||"gap-4",q=s.container.justifyContent||"start",C=s.autoHeight||!1,D=n.useCallback(()=>{o||e.length<=1||(u(!0),g("next"),setTimeout(()=>{h(c),g(null),u(!1)},b),l==null||l(c))},[r,e.length,o,c,b,l]),K=n.useCallback(()=>{o||e.length<=1||(u(!0),g("prev"),setTimeout(()=>{h(f),g(null),u(!1)},b),l==null||l(f))},[r,e.length,o,f,b,l]),Q=n.useCallback(a=>{o||a===r||a<0||a>=e.length||(u(!0),h(a),setTimeout(()=>{u(!1)},b),l==null||l(a))},[r,e.length,o,b,l]),H=n.useCallback((a,j)=>{if($(R=>({...R,[a]:!0})),!C)return;const k=j.currentTarget.offsetHeight;m(R=>({...R,[a]:k})),a===r&&w(k)},[C,r]),O=n.useCallback(a=>{const j=I=>{const[T,A]=I.split("/").map(Number);return{width:T,height:A}},y=j(s.container.aspectRatio),k=j(s.activeSlide.aspectRatio),R=j(s.nextSlide.aspectRatio),te=a*y.height/y.width,F=I=>{if(I==="100%")return 1;if(I==="0%")return 0;if(I.includes("/")){const[T,A]=I.split("/").map(Number);return T/A}return parseFloat(I.replace("%",""))/100},se=F(s.activeSlide.width),V=a*se,ae=V*k.height/k.width,ne=F(s.nextSlide.width),M=a*ne,re=M>0?M*R.height/R.width:0;return{container:{width:a,height:te},active:{width:V,height:ae},next:{width:M,height:re}}},[s]);n.useEffect(()=>{if(!_||C)return;const a=()=>{const y=_.offsetWidth,k=O(y);P(k),w(k.active.height)};a();const j=new ResizeObserver(a);return j.observe(_),()=>j.disconnect()},[_,O,C]),n.useEffect(()=>{if(!C)return;const a=p[r];a&&w(a)},[r,p,C]),n.useEffect(()=>{if(!s.autoPlay||e.length<=1)return;const a=setInterval(()=>{D()},s.autoPlayInterval||5001);return()=>clearInterval(a)},[s.autoPlay,s.autoPlayInterval,D,e.length]);const Z=()=>{switch(E){case"start":return"items-start";case"center":return"items-center";case"end":return"items-end";default:return"items-start"}},U=()=>{switch(q){case"start":return"justify-start";case"end":return"justify-end";case"center":return"justify-center";case"between":return"justify-between";case"around":return"justify-around";case"evenly":return"justify-evenly";default:return"justify-start"}},W=()=>{const a=s.navigationStyle||{},j=a.size||"md",y=a.color||"light",k={sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"},R={light:"bg-white/80 hover:bg-white text-gray-600",dark:"bg-black/80 hover:bg-black text-white"};return`${k[j]} ${R[y]} rounded-full flex items-center justify-center transition-colors shadow-lg disabled:opacity-50 disabled:cursor-not-allowed`},ee=()=>{const a=s.paginationStyle||{},j=a.position||"bottom-left",y=a.style||"dots";return{container:`${{"bottom-left":"absolute bottom-4 left-4","bottom-center":"absolute bottom-4 left-1/2 transform -translate-x-1/2","bottom-right":"absolute bottom-4 right-4","top-left":"absolute top-4 left-4","top-center":"absolute top-4 left-1/2 transform -translate-x-1/2","top-right":"absolute top-4 right-4"}[j]} z-10 flex space-x-2`,button:y==="bars"?"w-6 h-1 rounded-full":"w-2 h-2 rounded-full"}};return e.length===0?t.jsx("div",{className:`bg-gray-200 ${x}`,style:{aspectRatio:s.container.aspectRatio}}):e.length===1?t.jsx("div",{ref:S,className:`relative overflow-hidden ${x}`,style:{height:d?`${d}px`:void 0,transition:`height ${b}ms ease-in-out`},children:t.jsx("img",{src:e[0].file_path,alt:e[0].alt||"",className:"w-full h-full object-cover",onLoad:a=>H(0,a),style:{display:"block"}})}):t.jsxs("div",{ref:S,className:`relative overflow-hidden flex ${X} ${Z()} ${U()} ${x}`,style:{height:d?`${d}px`:void 0,transition:`height ${b}ms ease-in-out`,touchAction:"pan-y"},children:[t.jsxs("div",{className:"overflow-hidden flex-shrink-0 relative",style:{width:v?`${v.active.width}px`:"100%",height:v?`${v.active.height}px`:"100%"},children:[t.jsxs("div",{className:`absolute inset-0 transition-opacity duration-300 group-hover:scale-105 ${N[r]?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${e[r].file_path})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[!N[r]&&t.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center",children:t.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-[#D19B4C] rounded-full animate-spin"})}),t.jsx("img",{src:e[r].file_path,alt:e[r].alt||`Slide ${r+1}`,className:"hidden",onLoad:a=>H(r,a)})]}),o&&i&&t.jsx("div",{className:"absolute inset-0 transition-transform ease-in-out",style:{transitionDuration:`${b}ms`,transform:i==="next"?"translateX(-100%)":"translateX(100%)",backgroundImage:`url(${e[i==="next"?c:f].file_path})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",left:i==="next"?"100%":"-100%"}})]}),s.nextSlide.width!=="0%"&&v&&v.next.width>0&&t.jsx("div",{className:"overflow-hidden flex-shrink-0 relative",style:{width:`${v.next.width}px`,height:`${v.next.height}px`},children:t.jsxs("div",{className:`hover:opacity-90 cursor-pointer transition-all duration-300 hover:scale-105 ${N[c]?"opacity-80":"opacity-0"}`,style:{width:`${v.next.width}px`,height:`${v.next.height}px`,transform:s.nextSlide.scale?`scale(${s.nextSlide.scale})`:void 0,transformOrigin:"top",backgroundImage:`url(${e[c].file_path})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},onClick:D,children:[!N[c]&&t.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),t.jsx("img",{src:e[c].file_path,alt:e[c].alt||`Slide ${c+1}`,className:"hidden",onLoad:a=>H(c,a)})]})}),s.showNavigation&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:K,disabled:o,className:`absolute left-4 top-1/2 transform -translate-y-1/2 z-10 ${W()}`,children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("button",{onClick:D,disabled:o,className:`absolute right-4 top-1/2 transform -translate-y-1/2 z-10 ${W()}`,children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),s.showPagination&&(()=>{const a=ee();return t.jsx("div",{className:a.container,children:e.map((j,y)=>t.jsx("button",{onClick:()=>Q(y),disabled:o,className:`${a.button} transition-colors duration-200 ${y===r?"bg-[#D19B4C]":"bg-gray-400 hover:bg-gray-600"} disabled:cursor-not-allowed`},y))})})()]})};var B=new Map,L=new WeakMap,G=0,he=void 0;function me(e){return e?(L.has(e)||(G+=1,L.set(e,G.toString())),L.get(e)):"0"}function fe(e){return Object.keys(e).sort().filter(s=>e[s]!==void 0).map(s=>`${s}_${s==="root"?me(e.root):e[s]}`).toString()}function xe(e){const s=fe(e);let x=B.get(s);if(!x){const l=new Map;let r;const h=new IntersectionObserver(o=>{o.forEach(u=>{var d;const w=u.isIntersecting&&r.some(p=>u.intersectionRatio>=p);e.trackVisibility&&typeof u.isVisible>"u"&&(u.isVisible=w),(d=l.get(u.target))==null||d.forEach(p=>{p(w,u)})})},e);r=h.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),x={id:s,observer:h,elements:l},B.set(s,x)}return x}function ge(e,s,x={},l=he){if(typeof window.IntersectionObserver>"u"&&l!==void 0){const d=e.getBoundingClientRect();return s(l,{isIntersecting:l,target:e,intersectionRatio:typeof x.threshold=="number"?x.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:r,observer:h,elements:o}=xe(x),u=o.get(e)||[];return o.has(e)||o.set(e,u),u.push(s),h.observe(e),function(){u.splice(u.indexOf(s),1),u.length===0&&(o.delete(e),h.unobserve(e)),o.size===0&&(h.disconnect(),B.delete(r))}}function pe({threshold:e,delay:s,trackVisibility:x,rootMargin:l,root:r,triggerOnce:h,skip:o,initialInView:u,fallbackInView:d,onChange:w}={}){var p;const[m,N]=n.useState(null),$=n.useRef(w),[_,S]=n.useState({inView:!!u,entry:void 0});$.current=w,n.useEffect(()=>{if(o||!m)return;let g;return g=ge(m,(c,f)=>{S({inView:c,entry:f}),$.current&&$.current(c,f),f.isIntersecting&&h&&g&&(g(),g=void 0)},{root:r,rootMargin:l,threshold:e,trackVisibility:x,delay:s},d),()=>{g&&g()}},[Array.isArray(e)?e.toString():e,m,r,l,h,o,x,d,s]);const v=(p=_.entry)==null?void 0:p.target,P=n.useRef(void 0);!m&&v&&!h&&!o&&P.current!==v&&(P.current=v,S({inView:!!u,entry:void 0}));const i=[N,_.inView,_.entry];return i.ref=i[0],i.inView=i[1],i.entry=i[2],i}const be=oe.memo(({project:e,projectDetails:s,loadingDetails:x,loadProjectDetails:l,isReversed:r=!1})=>{const{ref:h,inView:o}=pe({threshold:.1,triggerOnce:!0,rootMargin:"100px 0px"});n.useEffect(()=>{o&&l(e.uuid)},[o,e.uuid,l]);const d=s[e.uuid]||e,w=x.has(e.uuid),p=n.useMemo(()=>{const m=[];return d.main_image&&m.push(d.main_image),d.images&&m.push(...d.images),m},[d.main_image,d.images]);return t.jsx("div",{ref:h,className:"group",id:`project-${e.uuid}`,children:t.jsxs("div",{className:`bg-white overflow-hidden duration-300 flex flex-col ${r?"lg:flex-row-reverse":"lg:flex-row"}`,children:[p.length>0&&t.jsxs("div",{className:`order-first ${r?"lg:order-first":"lg:order-last"} relative w-full lg:w-7/12`,children:[p.length===1?t.jsx("div",{className:"aspect-[4/3] overflow-hidden",children:t.jsx("img",{src:z(p[0].file_path),alt:`${e.title} 圖片`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"lg:hidden",children:t.jsx(Y,{images:p.map(m=>({file_path:z(m.file_path),alt:`${e.title} 圖片`})),config:{container:{aspectRatio:"4/5",alignItems:"start"},activeSlide:{aspectRatio:"4/5",width:"100%"},nextSlide:{aspectRatio:"4/5",width:"0%"},autoHeight:!1,showNavigation:!0,showPagination:!0,transitionDuration:300}})}),t.jsx("div",{className:"hidden lg:block",children:t.jsx(Y,{images:p.map(m=>({file_path:z(m.file_path),alt:`${e.title} 圖片`})),config:{container:{aspectRatio:"4/5",alignItems:"start",justifyContent:"between"},activeSlide:{aspectRatio:"4/5",width:"7/12"},nextSlide:{aspectRatio:"4/5",width:"5/12",scale:1},autoHeight:!1,showNavigation:!1,showPagination:!1,transitionDuration:800,autoPlay:!0,autoPlayInterval:5e3}})})]}),w&&t.jsx("div",{className:"absolute top-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded z-20",children:"載入更多圖片..."})]}),t.jsxs("div",{className:"pt-8 lg:p-6 flex-1 flex flex-col justify-end",children:[t.jsxs("div",{className:"mb-4 flex items-end justify-start space-x-8",children:[t.jsx("h4",{className:"text-main-title-mobile lg:text-main-title-desktop font-bold text-gray-900 tracking-[0.25em]",children:e.title}),t.jsxs("div",{className:"text-sub-title-mobile lg:text-sub-title-desktop text-primary-more font-medium",children:["/ ",e.year||"---"]})]}),t.jsxs("div",{className:"space-y-3 text-content-mobile lg:text-content-desktop",children:[e.base_address&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"基地位置"}),t.jsx("span",{className:"font-medium",children:e.base_address})]}),e.area&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"基地面積"}),t.jsx("span",{className:"font-medium",children:e.area})]}),e.unit_count!=null&&e.unit_count>0&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"總戶數"}),t.jsxs("span",{className:"font-medium",children:[e.unit_count," 戶"]})]}),e.floor_plan_info&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"樓層規劃"}),t.jsx("span",{className:"font-medium",children:e.floor_plan_info})]}),e.booking_phone&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"預約專線"}),t.jsx("span",{className:"font-medium",children:e.booking_phone})]}),e.subtitle&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"副標題"}),t.jsx("span",{className:"font-medium",children:e.subtitle})]}),e.description&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"專案描述"}),t.jsx("span",{className:"font-medium",children:e.description})]}),e.status&&t.jsxs("div",{className:"!hidden justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"專案狀態"}),t.jsxs("span",{className:"font-medium",children:[e.status==="planning"&&"籌備中",e.status==="pre_sale"&&"預售",e.status==="on_sale"&&"銷售中",e.status==="sold_out"&&"完銷",e.status==="completed"&&"完工"]})]}),d.custom_fields&&d.custom_fields.length>0&&t.jsx(t.Fragment,{children:d.custom_fields.map((m,N)=>m.value&&m.label&&m.value.toString().trim()!==""&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:m.label}),t.jsx("span",{className:"font-medium",children:m.value})]},N))}),(e.info_website||e.facebook_page)&&t.jsxs("div",{className:"flex justify-start space-x-4 border-b border-primary-line pb-1 text-black tracking-widest",children:[t.jsx("span",{className:"w-[6.25em]",children:"相關連結"}),t.jsxs("div",{className:"flex flex-row space-x-3",children:[e.info_website&&t.jsx("a",{href:e.info_website,target:"_blank",rel:"noopener noreferrer",className:"text-primary-more hover:text-primary transition-colors duration-200",title:"專案網站",children:t.jsx(ue,{className:"h-5 w-5"})}),e.facebook_page&&t.jsx("a",{href:e.facebook_page,target:"_blank",rel:"noopener noreferrer",className:"text-primary-more hover:text-primary transition-colors duration-200",title:"Facebook 專頁",children:t.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})})]})]})]})]})]})})}),Ne=()=>{const[e,s]=n.useState([]),[x,l]=n.useState(!0),[r,h]=n.useState(null),[o,u]=n.useState(!1),[d,w]=n.useState(0),[p,m]=n.useState({}),[N,$]=n.useState(new Set),_=288;n.useEffect(()=>{let i=!0;(async()=>{i&&await S()})();const c=()=>{const f=window.location.hash;if(f&&f.startsWith("#project-")){const b=f.replace("#project-","");setTimeout(()=>{const E=document.getElementById(`project-${b}`);E&&E.scrollIntoView({behavior:"smooth",block:"center"})},1e3)}};return c(),window.addEventListener("hashchange",c),()=>{i=!1,window.removeEventListener("hashchange",c)}},[]),n.useEffect(()=>{const i=()=>w(window.scrollY);return window.addEventListener("scroll",i,{passive:!0}),()=>window.removeEventListener("scroll",i)},[]);const S=async(i=0)=>{var g,c,f;try{l(!0);const b=await J.getProjects({display_page:"澤暘作品"});b.success&&((g=b.data)!=null&&g.items)?(s(b.data.items),h(null)):h("專案列表載入失敗")}catch(b){if(console.error("Failed to load projects:",b),((c=b.response)==null?void 0:c.status)===429&&i<2){console.log(`Rate limited, retrying in ${(i+1)*5} seconds...`),h(`請求過於頻繁，${(i+1)*5} 秒後重試...`),setTimeout(()=>{S(i+1)},(i+1)*5e3);return}((f=b.response)==null?void 0:f.status)===429?h("請求過於頻繁，請稍後再試"):h("載入專案時發生錯誤")}finally{(!r||!r.includes("重試"))&&l(!1)}},v=n.useCallback(async i=>{var g;if(!(p[i]||N.has(i)))try{$(f=>new Set(f).add(i));const c=await J.getProject(i);c.success&&((g=c.data)!=null&&g.project)&&m(f=>({...f,[i]:c.data.project}))}catch(c){console.error(`Failed to load details for project ${i}:`,c)}finally{$(c=>{const f=new Set(c);return f.delete(i),f})}},[p,N]);if(x)return t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"text-lg",children:"載入中..."})});if(r&&!r.includes("重試"))return t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg text-red-600 mb-4",children:r}),t.jsx("button",{onClick:()=>S(0),className:"px-4 py-2 bg-[#D19B4C] text-white rounded hover:bg-[#C18B3C] transition-colors",children:"重新載入"})]})});const P={logoSection:{iconSrc:"/images/logo-icon-brand.svg",iconAlt:"澤暘建設",subtitle:"CLASSIC PROJECTS",title:"澤暘作品"},centralContent:{text:`澤暘建築雕琢的不只是生活
更是一座城市的文化居所，是美學與工藝的時代之作`},backgroundImage:"/images/project/top-bn-project.jpg"};return t.jsxs("div",{className:"min-h-screen bg-white",style:{touchAction:"pan-y"},children:[t.jsxs(ce,{config:P,children:[t.jsx(ie,{isOpen:o,onClick:()=>u(!o),color:d>_?"dark":"light"}),t.jsx(le,{isOpen:o,onClose:()=>u(!1)})]}),t.jsx("section",{className:"py-16 lg:py-24",children:t.jsxs("div",{className:"container mx-auto px-4 lg:px-12 relative",children:[t.jsx("div",{className:"text-left relative lg:absolute top-0 left-0 pl-4 lg:pl-12 z-20 mb-16 lg:mb-0",children:t.jsx("h2",{className:"text-gray-400 text-main-large-title-mobile lg:text-main-large-title-desktop font-thin",children:"#PROJECTS"})}),e.length>0?t.jsx("div",{className:"flex flex-wrap flex-col gap-8 lg:gap-16",children:e.map((i,g)=>t.jsx(be,{project:i,projectDetails:p,loadingDetails:N,loadProjectDetails:v,isReversed:g%2===1},i.uuid))}):t.jsx("div",{className:"text-center py-16",children:t.jsx("p",{className:"text-gray-500 text-lg",children:"目前暫無專案資料"})})]})})]})};export{Ne as default};
//# sourceMappingURL=index-CPs7BEVN.js.map
